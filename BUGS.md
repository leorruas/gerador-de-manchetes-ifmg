
# Documento de Bugs

Este documento rastreia os bugs identificados no projeto MancheteExpress, seu status e as resoluções aplicadas.

| ID | Descrição do Bug | Status | Notas de Resolução |
| :--- | :--- | :--- | :--- |
| **BUG-001** | `Uncaught SyntaxError: The requested module '.../constants.js' doesn't provide an export named: 'ExportIcon'`. O erro impedia a execução de qualquer script, resultando em uma tela preta no deploy. | **Fechado** | Corrigido refatorando as importações de módulos em `index.js` e `canvasExport.js` para usar "namespace imports" (`import * as ...`). Isso tornou a resolução de dependências mais robusta, contornando problemas de cache e carregamento de módulos no ambiente de hospedagem estática. |
| **BUG-002** | O ícone para reenquadrar a imagem ("crop") era um ícone de "frame", o que era visualmente confuso. | **Fechado** | O ícone foi substituído por um SVG de "crop" mais padrão e intuitivo, melhorando a clareza da interface. A alteração foi feita em `constants.js`. |
| **BUG-003** | No modal de reenquadramento, a imagem de preview podia sobrepor os botões de "Salvar" e "Cancelar" em formatos com proporções altas (ex: Stories), quebrando o layout. | **Fechado** | O layout do modal foi ajustado em `index.js` para garantir que a área da imagem seja contida dentro do espaço disponível, adicionando `max-w-full`, `max-h-full` e `overflow-hidden` aos contêineres apropriados. |
| **BUG-004** | O logo do IFMG na caixa de manchete parecia muito grande, pois o SVG original continha texto e elementos adicionais que ocupavam espaço. | **Fechado** | O SVG do logo em `constants.js` foi editado para remover todos os elementos de texto, mantendo apenas o fundo circular e a grade icônica. Isso centraliza e dimensiona corretamente a parte principal do logo. |
| **BUG-005** | A funcionalidade de arrastar e soltar (drag-and-drop) para ajustar a posição vertical da caixa de texto não estava funcionando. Além disso, a caixa de texto não aparecia na posição correta ao carregar a imagem. | **Fechado** | Corrigido em `index.js` removendo uma propriedade CSS `transform` conflitante no template da caixa de texto. Adicionalmente, o código de posicionamento inicial foi envolvido em `requestAnimationFrame` para garantir que o cálculo ocorra após a renderização completa, exibindo a caixa na posição correta imediatamente. |
| **BUG-006** | A funcionalidade de arrastar a imagem no modal de reenquadramento estava quebrada devido a um erro de digitação (variável indefinida). | **Fechado** | Corrigido um typo no manipulador de eventos `onDrag` em `index.js`, que impedia o reposicionamento vertical (`y`) da imagem. |
| **BUG-007** | No modal de reenquadramento, a área de preview da imagem não é exibida, mostrando um espaço vazio. Isso foi uma regressão causada por uma correção anterior (BUG-003). | **Fechado** | O `div` que contém a imagem no modal utilizava `max-w-full` e `max-h-full` sem ter uma largura (`width`) definida, fazendo com que ele colapsasse para 0px de largura. Adicionada a classe `w-full` ao elemento em `index.js` para garantir que ele ocupe o espaço horizontal disponível, permitindo que o `aspect-ratio` calcule a altura corretamente e torne a imagem visível. |
| **BUG-008** | O logo do IFMG aparece achatado em alguns computadores, pois o `viewBox` do SVG não era quadrado e o contêiner de exibição força essa proporção, causando distorção. | **Fechado** | O `viewBox` do SVG em `constants.js` foi ajustado para `0 0 183 183`, tornando-o quadrado para corresponder ao design circular do logo. A propriedade `preserveAspectRatio="xMidYMid meet"` também foi adicionada para garantir a escala uniforme em todos os ambientes. |
| **BUG-009** | A área do logo nas imagens de Instagram era considerada pequena, diminuindo o destaque da marca. | **Fechado** | O tamanho do logo foi aumentado de 120px para 140px (em uma base de 1080px de largura). A alteração foi aplicada tanto na pré-visualização (`index.js`) quanto na lógica de exportação final (`services/canvasExport.js`) para garantir consistência. |
| **BUG-010** | O efeito de desfoque (blur) na caixa de texto aparecia na pré-visualização, mas não na imagem exportada. | **Fechado** | A pré-visualização usa CSS (`backdrop-filter`) para o efeito, que não é aplicado no canvas. A lógica de exportação em `services/canvasExport.js` foi atualizada para replicar o efeito: antes de desenhar a caixa de texto, uma cópia recortada e desfocada da imagem de fundo é desenhada na mesma área, garantindo que a imagem final seja idêntica à pré-visualização. |
| **BUG-011** | A quebra de linha do texto na imagem exportada era diferente da pré-visualização, especialmente quando o usuário inseria quebras de linha manuais. | **Fechado** | A lógica de renderização de texto no canvas (`services/canvasExport.js`) foi refeita. Foi criada uma função central (`getTextLines`) que calcula as quebras de linha, respeitando os parágrafos definidos pelo usuário (via `\n`). Tanto o cálculo da altura do texto quanto o desenho final usam essa função, garantindo que a imagem exportada seja um espelho fiel da pré-visualização. |
| **BUG-012** | No modal de reenquadramento, a área de preview para formatos de proporção alta (como Stories) transborda verticalmente, empurrando o rodapé do modal para fora da área visível. Isso ocorre porque a largura da área de preview é forçada a 100%, o que calcula uma altura que não respeita os limites verticais do contêiner. | **Fechado** | Removida a classe `w-full` do contêiner com `aspect-ratio` dentro do modal de reenquadramento (`index.js`). Isso permite que o navegador resolva corretamente as restrições de layout, usando `max-h-full` para limitar a altura e, em seguida, calculando a largura apropriada para manter a proporção, evitando o transbordamento vertical. Esta correção revisita a solução do `BUG-007`, pois o layout do contêiner pai foi aprimorado desde então para fornecer uma altura estável. |
| **BUG-013** | O layout do modal de reenquadramento é instável, com a área de preview às vezes transbordando e às vezes colapsando para 0px, dependendo da proporção da imagem. As correções anteriores (`BUG-007`, `BUG-012`) eram soluções parciais que conflitavam entre si. | **Fechado** | A estrutura HTML do modal de reenquadramento (`CropModal` em `index.js`) foi simplificada. A solução definitiva foi aplicar as propriedades `max-w-full`, `max-h-full` e `aspect-ratio` em um único contêiner. Isso permite que o navegador dimensione de forma robusta a área de preview para caber perfeitamente no espaço disponível, seja a largura ou a altura o fator limitante. A experiência de reenquadramento agora é estável para todas as proporções de imagem. |
| **BUG-014** | A área de reenquadramento no modal, embora tecnicamente contida, ainda era muito grande para formatos de proporção alta (Stories, Post), parecendo cortada e dificultando o uso. O "respiro" visual em volta da ferramenta era insuficiente. | **Fechado** | Aumentado o padding do contêiner principal do modal de reenquadramento de `p-6` para `p-8` em `index.js`. Essa mudança simples força a área de preview a escalar para um tamanho menor, garantindo que ela e seus controles fiquem totalmente visíveis com uma margem confortável, resolvendo o problema de usabilidade para todas as proporções de imagem. |
| **BUG-015** | Mesmo após as correções anteriores, o modal de reenquadramento ainda parecia "apertado" e difícil de usar em formatos de proporção extrema, como Stories. A solução de padding não era suficientemente robusta. | **Fechado** | Implementada uma solução de layout estrutural em `index.js`. A área de preview foi envolvida por um novo contêiner com as classes `w-[95%]` e `h-[95%]`. Este "contêiner de segurança" força a ferramenta de reenquadramento a ocupar no máximo 95% do espaço disponível, garantindo uma margem visual ampla e consistente em todos os lados para todas as proporções, resolvendo definitivamente o problema de usabilidade. |
| **BUG-016** | O fluxo de reenquadramento de imagem, baseado em um modal, era instável e pouco intuitivo. A separação da visualização principal para um modal causava uma quebra na experiência do usuário e era a fonte de múltiplos bugs de layout (BUG-012, 013, 014, 015). | **Fechado** | O modal de reenquadramento foi completamente **removido**. A funcionalidade foi refeita para uma experiência de **edição no local (in-place)**. Clicar no ícone de reenquadrar agora exibe os controles de zoom, salvar e cancelar diretamente sobre o preview da imagem, que se torna arrastável. Essa abordagem é mais estável, intuitiva e elimina a causa raiz dos bugs de layout anteriores. |
